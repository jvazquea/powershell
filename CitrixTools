#Generated Form Function
$scriptPath = split-path -parent $MyInvocation.MyCommand.Definition
asnp Citrix.*

$x = @()
function GenerateForm {
########################################################################
# Code Generated By: SAPIEN Technologies PrimalForms (Community Edition) v1.0.10.0
# Generated On: 07/08/2015 9:49
# Generated By: Javier Vázquez Martín
########################################################################

#region Import the Assemblies
[reflection.assembly]::loadwithpartialname("System.Windows.Forms") | Out-Null
[reflection.assembly]::loadwithpartialname("System.Drawing") | Out-Null
#endregion

#region Generated Form Objects
$form1 = New-Object System.Windows.Forms.Form
$InitialFormWindowState = New-Object System.Windows.Forms.FormWindowState

#tabs
$Permisos = New-Object System.Windows.Forms.TabControl
$Users_tab = New-Object System.Windows.Forms.TabPage
$PublishNew = New-Object System.Windows.Forms.TabPage
$tabPage2 = New-Object System.Windows.Forms.TabPage

#labels
$label4 = New-Object System.Windows.Forms.Label
$label1 = New-Object System.Windows.Forms.Label
$label3 = New-Object System.Windows.Forms.Label
$WorkingDir = New-Object System.Windows.Forms.Label
$Serv_App_new = New-Object System.Windows.Forms.Label
$Command_Line_Lab = New-Object System.Windows.Forms.Label
$Cli_app_folder_lab = New-Object System.Windows.Forms.Label
$label2 = New-Object System.Windows.Forms.Label
$AppDescription_lab = New-Object System.Windows.Forms.Label
$DisplayName_lab = New-Object System.Windows.Forms.Label

#textbox
$Dom_group = New-Object System.Windows.Forms.TextBox
$Groups_app = New-Object System.Windows.Forms.TextBox
$App_server = New-Object System.Windows.Forms.TextBox
$Dir_App = New-Object System.Windows.Forms.TextBox
$pkg_cmd = New-Object System.Windows.Forms.TextBox
$Cli_App_Folder = New-Object System.Windows.Forms.TextBox
$App_Description = New-Object System.Windows.Forms.TextBox
$DisplayName = New-Object System.Windows.Forms.TextBox

#buttons
$Refresh = New-Object System.Windows.Forms.Button
$exp_perm_file = New-Object System.Windows.Forms.Button
$Export_txt = New-Object System.Windows.Forms.Button
$Permissions_app = New-Object System.Windows.Forms.Button
$Remove = New-Object System.Windows.Forms.Button
$Add = New-Object System.Windows.Forms.Button
$exp_app_srv = New-Object System.Windows.Forms.Button
$Perm_server = New-Object System.Windows.Forms.Button
$Check_srv = New-Object System.Windows.Forms.Button
$Uncheck_srv = New-Object System.Windows.Forms.Button
$Publish = New-Object System.Windows.Forms.Button
$Unpublish = New-Object System.Windows.Forms.Button
$Publish_New_App = New-Object System.Windows.Forms.Button
$Check_app = New-Object System.Windows.Forms.Button
$Unchech_app = New-Object System.Windows.Forms.Button

#checkedlistboxes
$Servers_list = New-Object System.Windows.Forms.CheckedListBox
$Applications = New-Object System.Windows.Forms.CheckedListBox
$Servers_pub_new_app = New-Object System.Windows.Forms.CheckedListBox

#radiobuttons
$Streamed_App = New-Object System.Windows.Forms.RadioButton
$Local_App = New-Object System.Windows.Forms.RadioButton


#endregion Generated Form Objects

#Import CSV with applications and permissions

If((Test-Path -path $scriptPath\apps.csv)) {
$apps = import-csv $scriptPath\apps.csv|sort-object ApplicationName 
}
else {

$nombrefile="apps.csv"
$file = [string]"$scriptPath\$nombrefile"
$filetemp = [string]"$scriptPath\app-listtemp.csv"
$datos=Get-XAApplicationReport * | select @{n="ApplicationName";e={[string]::join(";", $_.Browsername)}}, @{n="UsersandGroups";e={[string]::join(" ; ", $_.Accounts)}}, @{n="Servers";e={[string]::join(";", $_.ServerNames)}}, @{n="Habilitada";e={[string]::join(" ; ", $_.Enabled)}}

for ($i=0;$i -lt $datos.length;$i++) {

   if ($datos[$i].servers -gt 0) {
      $text=$datos[$i].servers.split("{;}")
      $text=$text|sort-object
      $cuenta=$text.count
      $prueba=$text -join " ; "
      $datos[$i].servers=$prueba
   }
}

$datos|Export-Csv $file
get-content $file |select -Skip 1 |set-content "$filetemp"
move "$filetemp" $file -Force
$apps = import-csv $scriptPath\apps.csv|sort-object ApplicationName 

}

$servers=get-xaserver|sort-object Servername

    $n=0
    foreach($test in $servers)
    {
    $server=$servers[$n].Servername
    [void] $Servers_list.Items.Add("$server")
	[void] $Servers_pub_new_app.Items.Add("$server")
	$n=$n+1
    }


#----------------------------------------------
#Generated Event Script Blocks
#----------------------------------------------
#Provide Custom Code for events specified in PrimalForms.
$handler_label6_Click= 
{
#TODO: Place custom script here

}

$handler_button3_Click= 
{
#TODO: Place custom script here

}

$exp_perm_file_OnClick= 
{
#TODO: Place custom script here

}

$handler_checkedListBox1_SelectedIndexChanged= 
{
#TODO: Place custom script here

}

$handler_Cli_app_folder_Click= 
{
#TODO: Place custom script here

}

$permission_app_Click= 
{

    $n=0
    $apps = import-csv $scriptPath\apps.csv|sort-object ApplicationName, Habilitada 
    $numero=$Applications.CheckedItems.count -1
    $permiso = (0 .. $numero)
    foreach ($objItem in $Applications.CheckedItems)
	{
	$app="$objItem"
	$datos = $apps|where {$_.ApplicationName -eq $app}|select UsersandGroups, Habilitada
	$grupo = $datos.UsersandGroups
	$enabled = $datos.Habilitada
    IF ($enabled -eq "True") {$state = "Enabled"}
	else {$state = "Disabled"}
	$permiso[$n] = "Application permissions " + $app + ": " + $state + "`r`n" + $grupo + "`r`n" + "`r`n"
	$n = $n + 1
	}

    $Groups_app.Text = $permiso
    
}

$exp_app_srv_OnClick=
{
        if ($App_server.text -ne $empty) {
	set-content -path $scriptpath\app-servers.txt -value $App_server.text
        }
}

$Check_app_OnClick= 
{

        for ($i=0;$i -lt $Applications.Items.count;$i++) {
            $Applications.SetItemchecked($i,$True)
        }
    
}

$Uncheck_srv_OnClick= 
{
        for ($i=0;$i -lt $Servers_list.Items.count;$i++) {
            $Servers_list.SetItemchecked($i,$False)
        }
    
}

$handler_textBox1_TextChanged= 
{
#TODO: Place custom script here

}

$Export_txt_OnClick= 
{
        if ($Groups_app.Text -ne $empty) {
	set-content -path $scriptpath\app-groups.txt -value $Groups_app.Text
        }
    
}

$handler_label2_Click= 
{
#TODO: Place custom script here

}

$uncheck_app_Click= 
{
        for ($i=0;$i -lt $Applications.Items.count;$i++) {
            $Applications.SetItemchecked($i,$False)
        }
    
}

$Check_srv_OnClick= 
{
        for ($i=0;$i -lt $Servers_list.Items.count;$i++) {
            $Servers_list.SetItemchecked($i,$True)
        }
    
}


$Remove_OnClick= 
{
    $appscheck = $Applications.CheckedItems
    $count=$appscheck.count
    $applicationchecked=(1..$count)
    IF ($Dom_group.Text -lt 0) {
	$message = "Empty field" + "`r`n"
	$wshell = New-Object -ComObject Wscript.Shell
   	$wshell.Popup($message,0,"Write a group name",0x0)
	} else {
        $i=0
        foreach ($objItem in $Applications.CheckedItems)
	    {
             $app="$objItem"
             $groups = $Dom_group.Text
	     $a = new-object -comobject wscript.shell
	     $Pregunta = $a.popup("Are you sure to remove permission in $app to the user/group?", 0,"Delete Files",4)
	     If ($Pregunta -eq 6) {
	      Remove-XAApplicationAccount $app -accounts $groups
	      $applicationchecked[$i]=$app
              $i++
	     }
	}
	   if ($i -eq 0){
	      $message = [string]"Cancelado"
	      $wshell = New-Object -ComObject Wscript.Shell
              $wshell.Popup($message,0,"Done",0x0)
           } else {
           $i--
	   $applicationchecked=$applicationchecked[0..$i]
	   $applicationchecked=$applicationchecked|out-string
	   $message = [string]"User/group removed " + $groups + " to applications " + "`r`n" + "$applicationchecked"
	   $wshell = New-Object -ComObject Wscript.Shell
           $wshell.Popup($message,0,"Done",0x0)
}
}
}

$handler_textBox4_TextChanged= 
{
#TODO: Place custom script here

}

$Publish_OnClick= 
{

	$apps=$Applications.CheckedItems
	$capps=$apps.count -1
	$servers=$Servers_list.CheckedItems
	$cservers=$servers.count -1
	$resapps=(0..$capps)
	$resservers=(0..$cservers)
	$j=0
	foreach ( $objItem in $Applications.CheckedItems ) {
	$i=0
	$app="$objItem"
	$resapps[$j]=$app
	$j++
	foreach ( $objServer in $Servers_list.CheckedItems ) {
           $server="$objServer"
	       Add-XAApplicationServer -BrowserName $app -ServerNames $server
	       $resservers[$i]=$server
           $i++
	   }
	}
	$resservers=$resservers|out-string
	$resapps=$resapps|out-string
	$message = [string]"Server/s " + "$resservers"+ " added to Application/s " + "$resapps" + "`r`n"
	$wshell = New-Object -ComObject Wscript.Shell
        $wshell.Popup($message,0,"Done",0x0)
}

$Unpublish_OnClick= 
{
	$apps=$Applications.CheckedItems
	$capps=$apps.count -1
	$servers=$Servers_list.CheckedItems
	$cservers=$servers.count -1
	$resapps=(0..$capps)
	$resservers=(0..$cservers)
	$j=0
	$a = new-object -comobject wscript.shell
	$Pregunta = $a.popup("Are you sure to remove permission in $app to the Servers Selected?", 0,"Delete Permission",4)
	If ($Pregunta -eq 6) {
		foreach ( $objItem in $Applications.CheckedItems ) {
		$i=0
		$app="$objItem"
		$resapps[$j]=$app
		$j++
		foreach ( $objServer in $Servers_list.CheckedItems ) {
             		$server="$objServer"
	     		Remove-XAApplicationServer -BrowserName $app -ServerNames $server
	    		$resservers[$i]=$server
             		$i++
	   	}
		}
	}
	$resservers=$resservers|out-string
	$resapps=$resapps|out-string
	$message = [string]"Server/s " + "$resservers"+ " removed to Application/s " + "$resapps" + "`r`n"
	$wshell = New-Object -ComObject Wscript.Shell
        $wshell.Popup($message,0,"Done",0x0)
}

$Publish_New_App_OnClick= 
{
   If ($Local_App.Checked -eq $true)
   {
   New-XAApplication $Displayname.text -ApplicationType ServerInstalled -CommandLineExecutable $pkg_cmd.text -WorkingDirectory $Dir_App.text -server $Servers_pub_new_app.CheckedItems -ClientFolder $Cli_App_Folder.text -ColorDepth "Colors16Bit" -AudioType None -AudioRequired $False -AddToClientStartMenu $False -WindowType "1024x768" -HideWhenDisabled $True
   }	
   else {
   New-XAApplication $Displayname.text -ApplicationType StreamedToClientOrStreamedToServer -ProfileLocation $pkg_cmd.text -ProfileProgramName $Dir_App.text -server $Servers_pub_new_app.CheckedItems -ClientFolder $Cli_App_Folder.text -ColorDepth "Colors16Bit" -AudioType None -AudioRequired $False -AddToClientStartMenu $False -WindowType "1024x768" -HideWhenDisabled $True
   }
}

$Perm_server_OnClick=
{

    $n=0
    $apps = import-csv $scriptPath\apps.csv|sort-object ApplicationName 
    $numero=$Applications.CheckedItems.count -1
    $right = (0 .. $numero)
    foreach ($objItem in $Applications.CheckedItems)
	{
	$app="$objItem"
	$servers = $apps|where {$_.ApplicationName -eq $app}|select Servers|sort-object Servers
	$server = $servers.servers
	$right[$n] = "Application " + $app + " published in: " + "`r`n" + $server + "`r`n" + "`r`n"
	$n = $n + 1
	}

    $App_server.text = $right
    
}


$Refresh_OnClick= 
{

    $nombrefile="apps.csv"
    $file = [string]"$scriptPath\$nombrefile"
    $filetemp = [string]"$scriptPath\app-listtemp.csv"
    $datos=Get-XAApplicationReport * | select @{n="ApplicationName";e={[string]::join(";", $_.Browsername)}}, @{n="UsersandGroups";e={[string]::join(" ; ", $_.Accounts)}}, @{n="Servers";e={[string]::join(";", $_.ServerNames)}}, @{n="Habilitada";e={[string]::join(" ; ", $_.Enabled)}}

   for ($i=0;$i -lt $datos.length;$i++) {

   if ($datos[$i].servers -gt 0) {
      $text=$datos[$i].servers.split("{;}")
      $text=$text|sort-object
      $cuenta=$text.count
      $prueba=$text -join " ; "
      $datos[$i].servers=$prueba
   }
   }

    $datos|Export-Csv $file
    get-content $file |select -Skip 1 |set-content "$filetemp"
    move "$filetemp" $file -Force
    $apps = import-csv $scriptPath\apps.csv|sort-object ApplicationName 

    $message = "Farm Data has been updated"
    $wshell = New-Object -ComObject Wscript.Shell
    $wshell.Popup($message,0,"Done",0x0)
    
    $Applications.Items.clear()

    $n=0
    foreach($test in $apps)
    {
    $app=$apps[$n].ApplicationName
    [void] $Applications.Items.Add("$app")
    $n=$n+1
    }

    $Servers_list.Items.clear()
    
    $servers=get-xaserver|sort-object Servername

    $n=0
    foreach($test in $servers)
    {
    $server=$servers[$n].Servername
    [void] $Servers_list.Items.Add("$server")
	[void] $Servers_pub_new_app.Items.Add("$server")
    $n=$n+1
    }

}


$handler_TabPage_Click= 
{
#TODO: Place custom script here

}


$Local_App_OnClick=
{
$Command_Line_Lab.Text = "Command line:"
$WorkingDir.Text = "Working directory:"
}
$Streamed_App_OnClick=
{
$Command_Line_Lab.Text = "Citrix streaming application profile address:"
$WorkingDir.Text = "Application to launch from the Citrix streaming application profile:"
}

$OnLoadForm_StateCorrection=
{#Correct the initial state of the form to prevent the .Net maximized form issue
	$form1.WindowState = $InitialFormWindowState
}



#----------------------------------------------
#region Generated Form Code
$form1.BackColor = [System.Drawing.Color]::FromArgb(255,212,208,200)
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 663
$System_Drawing_Size.Width = 851
$form1.ClientSize = $System_Drawing_Size
$form1.DataBindings.DefaultDataSourceUpdateMode = 0
$form1.Name = "form1"
$form1.Text = "Citrix tool"


$Refresh.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 148
$System_Drawing_Point.Y = 570
$Refresh.Location = $System_Drawing_Point
$Refresh.Name = "Refresh"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 56
$System_Drawing_Size.Width = 162
$Refresh.Size = $System_Drawing_Size
$Refresh.TabIndex = 8
$Refresh.Text = "Refresh (It takes)"
$Refresh.UseVisualStyleBackColor = $True
$Refresh.add_Click($Refresh_OnClick)

$form1.Controls.Add($Refresh)

$Permisos.Appearance = 1
$Permisos.DataBindings.DefaultDataSourceUpdateMode = 0
$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 352
$System_Drawing_Point.Y = 12
$Permisos.Location = $System_Drawing_Point
$Permisos.Name = "Permisos"
$Permisos.SelectedIndex = 0
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 642
$System_Drawing_Size.Width = 480
$Permisos.Size = $System_Drawing_Size
$Permisos.TabIndex = 19

$form1.Controls.Add($Permisos)
$Users_tab.BackColor = [System.Drawing.Color]::FromArgb(255,212,208,200)
$Users_tab.DataBindings.DefaultDataSourceUpdateMode = 0
$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 4
$System_Drawing_Point.Y = 25
$Users_tab.Location = $System_Drawing_Point
$Users_tab.Name = "Users_tab"
$System_Windows_Forms_Padding = New-Object System.Windows.Forms.Padding
$System_Windows_Forms_Padding.All = 3
$System_Windows_Forms_Padding.Bottom = 3
$System_Windows_Forms_Padding.Left = 3
$System_Windows_Forms_Padding.Right = 3
$System_Windows_Forms_Padding.Top = 3
$Users_tab.Padding = $System_Windows_Forms_Padding
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 613
$System_Drawing_Size.Width = 472
$Users_tab.Size = $System_Drawing_Size
$Users_tab.TabIndex = 0
$Users_tab.Text = "Users"
$Users_tab.add_Click($handler_TabPage:_Click)

$Permisos.Controls.Add($Users_tab)
$exp_perm_file.BackColor = [System.Drawing.Color]::FromArgb(255,212,208,200)

$exp_perm_file.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 391
$System_Drawing_Point.Y = 535
$exp_perm_file.Location = $System_Drawing_Point
$exp_perm_file.Name = "exp_perm_file"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 54
$System_Drawing_Size.Width = 75
$exp_perm_file.Size = $System_Drawing_Size
$exp_perm_file.TabIndex = 19
$exp_perm_file.Text = "Export permissions to file"
$exp_perm_file.UseVisualStyleBackColor = $False
$exp_perm_file.add_Click($exp_perm_file_OnClick)

$Users_tab.Controls.Add($exp_perm_file)

$label4.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 20
$System_Drawing_Point.Y = 17
$label4.Location = $System_Drawing_Point
$label4.Name = "label4"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 20
$System_Drawing_Size.Width = 100
$label4.Size = $System_Drawing_Size
$label4.TabIndex = 18
$label4.Text = "Application / Users"

$Users_tab.Controls.Add($label4)

$Dom_group.DataBindings.DefaultDataSourceUpdateMode = 0
$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 20
$System_Drawing_Point.Y = 494
$Dom_group.Location = $System_Drawing_Point
$Dom_group.Name = "Dom_group"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 20
$System_Drawing_Size.Width = 446
$Dom_group.Size = $System_Drawing_Size
$Dom_group.TabIndex = 4

$Users_tab.Controls.Add($Dom_group)


$Export_txt.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 880
$System_Drawing_Point.Y = 475
$Export_txt.Location = $System_Drawing_Point
$Export_txt.Name = "Export_txt"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 56
$System_Drawing_Size.Width = 75
$Export_txt.Size = $System_Drawing_Size
$Export_txt.TabIndex = 9
$Export_txt.Text = "Export permissions to file"
$Export_txt.UseVisualStyleBackColor = $True
$Export_txt.add_Click($Export_txt_OnClick)

$Users_tab.Controls.Add($Export_txt)

$Groups_app.DataBindings.DefaultDataSourceUpdateMode = 0
$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 20
$System_Drawing_Point.Y = 39
$Groups_app.Location = $System_Drawing_Point
$Groups_app.Multiline = $True
$Groups_app.Name = "Groups_app"
$Groups_app.ReadOnly = $True
$Groups_app.ScrollBars = 2
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 409
$System_Drawing_Size.Width = 446
$Groups_app.Size = $System_Drawing_Size
$Groups_app.TabIndex = 1
$Groups_app.add_TextChanged($handler_textBox1_TextChanged)

$Users_tab.Controls.Add($Groups_app)

$Permissions_app.BackColor = [System.Drawing.Color]::FromArgb(255,212,208,200)

$Permissions_app.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 310
$System_Drawing_Point.Y = 535
$Permissions_app.Location = $System_Drawing_Point
$Permissions_app.Name = "Permissions_app"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 54
$System_Drawing_Size.Width = 75
$Permissions_app.Size = $System_Drawing_Size
$Permissions_app.TabIndex = 10
$Permissions_app.Text = "Permissions application report"
$Permissions_app.UseVisualStyleBackColor = $False
$Permissions_app.add_Click($permission_app_Click)

$Users_tab.Controls.Add($Permissions_app)

$Remove.BackColor = [System.Drawing.Color]::FromArgb(255,212,208,200)

$Remove.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 20
$System_Drawing_Point.Y = 566
$Remove.Location = $System_Drawing_Point
$Remove.Name = "Remove"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 23
$System_Drawing_Size.Width = 79
$Remove.Size = $System_Drawing_Size
$Remove.TabIndex = 7
$Remove.Text = "Remove"
$Remove.UseVisualStyleBackColor = $False
$Remove.add_Click($Remove_OnClick)

$Users_tab.Controls.Add($Remove)

$label1.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 20
$System_Drawing_Point.Y = 473
$label1.Location = $System_Drawing_Point
$label1.Name = "label1"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 18
$System_Drawing_Size.Width = 300
$label1.Size = $System_Drawing_Size
$label1.TabIndex = 5
$label1.Text = "Domain group or user (use with format Domain\login)"

$Users_tab.Controls.Add($label1)

$Add.BackColor = [System.Drawing.Color]::FromArgb(255,212,208,200)

$Add.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 20
$System_Drawing_Point.Y = 533
$Add.Location = $System_Drawing_Point
$Add.Name = "Add"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 23
$System_Drawing_Size.Width = 79
$Add.Size = $System_Drawing_Size
$Add.TabIndex = 6
$Add.Text = "Add"
$Add.UseVisualStyleBackColor = $False
$Add.add_Click($handler_button3_Click)

$Users_tab.Controls.Add($Add)


$tabPage2.BackColor = [System.Drawing.Color]::FromArgb(255,212,208,200)
$tabPage2.DataBindings.DefaultDataSourceUpdateMode = 0
$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 4
$System_Drawing_Point.Y = 25
$tabPage2.Location = $System_Drawing_Point
$tabPage2.Name = "tabPage2"
$System_Windows_Forms_Padding = New-Object System.Windows.Forms.Padding
$System_Windows_Forms_Padding.All = 3
$System_Windows_Forms_Padding.Bottom = 3
$System_Windows_Forms_Padding.Left = 3
$System_Windows_Forms_Padding.Right = 3
$System_Windows_Forms_Padding.Top = 3
$tabPage2.Padding = $System_Windows_Forms_Padding
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 613
$System_Drawing_Size.Width = 472
$tabPage2.Size = $System_Drawing_Size
$tabPage2.TabIndex = 1
$tabPage2.Text = "Servers"

$Permisos.Controls.Add($tabPage2)
$exp_app_srv.BackColor = [System.Drawing.Color]::FromArgb(255,212,208,200)

$exp_app_srv.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 391
$System_Drawing_Point.Y = 535
$exp_app_srv.Location = $System_Drawing_Point
$exp_app_srv.Name = "exp_app_srv"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 54
$System_Drawing_Size.Width = 75
$exp_app_srv.Size = $System_Drawing_Size
$exp_app_srv.TabIndex = 20
$exp_app_srv.Text = "Export App/Srv to txt"
$exp_app_srv.UseVisualStyleBackColor = $False
$exp_app_srv.add_Click($exp_app_srv_OnClick)

$tabPage2.Controls.Add($exp_app_srv)

$Perm_server.BackColor = [System.Drawing.Color]::FromArgb(255,212,208,200)

$Perm_server.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 310
$System_Drawing_Point.Y = 535
$Perm_server.Location = $System_Drawing_Point
$Perm_server.Name = "Perm_server"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 54
$System_Drawing_Size.Width = 75
$Perm_server.Size = $System_Drawing_Size
$Perm_server.TabIndex = 19
$Perm_server.Text = "Application/Server Report"
$Perm_server.UseVisualStyleBackColor = $False
$Perm_server.add_Click($Perm_server_OnClick)

$tabPage2.Controls.Add($Perm_server)

$App_server.DataBindings.DefaultDataSourceUpdateMode = 0
$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 214
$System_Drawing_Point.Y = 39
$App_server.Location = $System_Drawing_Point
$App_server.Multiline = $True
$App_server.Name = "App_server"
$App_server.ReadOnly = $True
$App_server.ScrollBars = 2
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 409
$System_Drawing_Size.Width = 252
$App_server.Size = $System_Drawing_Size
$App_server.TabIndex = 18

$tabPage2.Controls.Add($App_server)

$Servers_list.DataBindings.DefaultDataSourceUpdateMode = 0
$Servers_list.FormattingEnabled = $True
$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 20
$System_Drawing_Point.Y = 39
$Servers_list.Location = $System_Drawing_Point
$Servers_list.Name = "Servers_list"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 409
$System_Drawing_Size.Width = 188
$Servers_list.Size = $System_Drawing_Size
$Servers_list.TabIndex = 12

$tabPage2.Controls.Add($Servers_list)

$Check_srv.BackColor = [System.Drawing.Color]::FromArgb(255,212,208,200)

$Check_srv.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 111
$System_Drawing_Point.Y = 468
$Check_srv.Location = $System_Drawing_Point
$Check_srv.Name = "Check_srv"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 23
$System_Drawing_Size.Width = 67
$Check_srv.Size = $System_Drawing_Size
$Check_srv.TabIndex = 14
$Check_srv.Text = "Check"
$Check_srv.UseVisualStyleBackColor = $False
$Check_srv.add_Click($Check_srv_OnClick)

$tabPage2.Controls.Add($Check_srv)

$label3.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 20
$System_Drawing_Point.Y = 17
$label3.Location = $System_Drawing_Point
$label3.Name = "label3"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 19
$System_Drawing_Size.Width = 100
$label3.Size = $System_Drawing_Size
$label3.TabIndex = 17
$label3.Text = "Servers:"

$tabPage2.Controls.Add($label3)

$Uncheck_srv.BackColor = [System.Drawing.Color]::FromArgb(255,212,208,200)

$Uncheck_srv.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 20
$System_Drawing_Point.Y = 468
$Uncheck_srv.Location = $System_Drawing_Point
$Uncheck_srv.Name = "Uncheck_srv"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 23
$System_Drawing_Size.Width = 67
$Uncheck_srv.Size = $System_Drawing_Size
$Uncheck_srv.TabIndex = 13
$Uncheck_srv.Text = "Uncheck"
$Uncheck_srv.UseVisualStyleBackColor = $False
$Uncheck_srv.add_Click($Uncheck_srv_OnClick)

$tabPage2.Controls.Add($Uncheck_srv)

$Publish.BackColor = [System.Drawing.Color]::FromArgb(255,212,208,200)

$Publish.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 20
$System_Drawing_Point.Y = 533
$Publish.Location = $System_Drawing_Point
$Publish.Name = "Publish"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 23
$System_Drawing_Size.Width = 79
$Publish.Size = $System_Drawing_Size
$Publish.TabIndex = 15
$Publish.Text = "Publish"
$Publish.UseVisualStyleBackColor = $False
$Publish.add_Click($Publish_OnClick)

$tabPage2.Controls.Add($Publish)

$Unpublish.BackColor = [System.Drawing.Color]::FromArgb(255,212,208,200)

$Unpublish.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 20
$System_Drawing_Point.Y = 566
$Unpublish.Location = $System_Drawing_Point
$Unpublish.Name = "Unpublish"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 23
$System_Drawing_Size.Width = 79
$Unpublish.Size = $System_Drawing_Size
$Unpublish.TabIndex = 16
$Unpublish.Text = "Unpublish"
$Unpublish.UseVisualStyleBackColor = $False
$Unpublish.add_Click($Unpublish_OnClick)

$tabPage2.Controls.Add($Unpublish)


$PublishNew.BackColor = [System.Drawing.Color]::FromArgb(255,212,208,200)
$PublishNew.DataBindings.DefaultDataSourceUpdateMode = 0
$PublishNew.ForeColor = [System.Drawing.Color]::FromArgb(255,0,0,0)
$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 4
$System_Drawing_Point.Y = 25
$PublishNew.Location = $System_Drawing_Point
$PublishNew.Name = "PublishNew"
$System_Windows_Forms_Padding = New-Object System.Windows.Forms.Padding
$System_Windows_Forms_Padding.All = 3
$System_Windows_Forms_Padding.Bottom = 3
$System_Windows_Forms_Padding.Left = 3
$System_Windows_Forms_Padding.Right = 3
$System_Windows_Forms_Padding.Top = 3
$PublishNew.Padding = $System_Windows_Forms_Padding
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 613
$System_Drawing_Size.Width = 472
$PublishNew.Size = $System_Drawing_Size
$PublishNew.TabIndex = 2
$PublishNew.Text = "Publish_New"

$Permisos.Controls.Add($PublishNew)

$Streamed_App.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 83
$System_Drawing_Point.Y = 111
$Streamed_App.Location = $System_Drawing_Point
$Streamed_App.Name = "Streamed_App"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 24
$System_Drawing_Size.Width = 104
$Streamed_App.Size = $System_Drawing_Size
$Streamed_App.TabIndex = 27
$Streamed_App.TabStop = $True
$Streamed_App.Text = "Streamed"
$Streamed_App.UseVisualStyleBackColor = $True
$Streamed_App.add_Click($Streamed_App_OnClick)

$PublishNew.Controls.Add($Streamed_App)


$Local_App.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 15
$System_Drawing_Point.Y = 111
$Local_App.Location = $System_Drawing_Point
$Local_App.Name = "Local_App"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 24
$System_Drawing_Size.Width = 104
$Local_App.Size = $System_Drawing_Size
$Local_App.TabIndex = 26
$Local_App.TabStop = $True
$Local_App.Text = "Local"
$Local_App.Checked = $true
$Local_App.UseVisualStyleBackColor = $True
$Local_App.add_Click($Local_App_OnClick)
$PublishNew.Controls.Add($Local_App)

$Dir_App.DataBindings.DefaultDataSourceUpdateMode = 0
$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 15
$System_Drawing_Point.Y = 201
$Dir_App.Location = $System_Drawing_Point
$Dir_App.Name = "Dir_App"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 20
$System_Drawing_Size.Width = 436
$Dir_App.Size = $System_Drawing_Size
$Dir_App.TabIndex = 3
$Dir_App.add_TextChanged($handler_textBox4_TextChanged)

$PublishNew.Controls.Add($Dir_App)


$Publish_New_App.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 15
$System_Drawing_Point.Y = 584
$Publish_New_App.Location = $System_Drawing_Point
$Publish_New_App.Name = "Publish_App"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 23
$System_Drawing_Size.Width = 75
$Publish_New_App.Size = $System_Drawing_Size
$Publish_New_App.TabIndex = 25
$Publish_New_App.Text = "Publish"
$Publish_New_App.UseVisualStyleBackColor = $True
$Publish_New_App.add_Click($Publish_New_App_OnClick)

$PublishNew.Controls.Add($Publish_New_App)

$WorkingDir.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 16
$System_Drawing_Point.Y = 183
$WorkingDir.Location = $System_Drawing_Point
$WorkingDir.Name = "WorkingDir"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 15
$System_Drawing_Size.Width = 400
$WorkingDir.Size = $System_Drawing_Size
$WorkingDir.TabIndex = 4
$WorkingDir.Text = "Working directory:"

$PublishNew.Controls.Add($WorkingDir)

$Serv_App_new.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 15
$System_Drawing_Point.Y = 246
$Serv_App_new.Location = $System_Drawing_Point
$Serv_App_new.Name = "Serv_App_new"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 14
$System_Drawing_Size.Width = 100
$Serv_App_new.Size = $System_Drawing_Size
$Serv_App_new.TabIndex = 24
$Serv_App_new.Text = "Servers:"

$PublishNew.Controls.Add($Serv_App_new)

$pkg_cmd.DataBindings.DefaultDataSourceUpdateMode = 0
$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 16
$System_Drawing_Point.Y = 159
$pkg_cmd.Location = $System_Drawing_Point
$pkg_cmd.Name = "pkg_cmd"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 20
$System_Drawing_Size.Width = 436
$pkg_cmd.Size = $System_Drawing_Size
$pkg_cmd.TabIndex = 2

$PublishNew.Controls.Add($pkg_cmd)

$Command_Line_Lab.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 15
$System_Drawing_Point.Y = 142
$Command_Line_Lab.Location = $System_Drawing_Point
$Command_Line_Lab.Name = "Command_Line_Lab"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 14
$System_Drawing_Size.Width = 300
$Command_Line_Lab.Size = $System_Drawing_Size
$Command_Line_Lab.TabIndex = 30
$Command_Line_Lab.Text = "Command line:"

$PublishNew.Controls.Add($Command_Line_Lab)

$Cli_App_Folder.DataBindings.DefaultDataSourceUpdateMode = 0
$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 15
$System_Drawing_Point.Y = 552
$Cli_App_Folder.Location = $System_Drawing_Point
$Cli_App_Folder.Name = "Cli_App_Folder"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 20
$System_Drawing_Size.Width = 436
$Cli_App_Folder.Size = $System_Drawing_Size
$Cli_App_Folder.TabIndex = 7

$PublishNew.Controls.Add($Cli_App_Folder)

$Cli_app_folder_lab.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 15
$System_Drawing_Point.Y = 532
$Cli_app_folder_lab.Location = $System_Drawing_Point
$Cli_app_folder_lab.Name = "Cli_app_folder_lab"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 17
$System_Drawing_Size.Width = 127
$Cli_app_folder_lab.Size = $System_Drawing_Size
$Cli_app_folder_lab.TabIndex = 22
$Cli_app_folder_lab.Text = "Client application folder:"
$Cli_app_folder_lab.add_Click($handler_Cli_app_folder_Click)

$PublishNew.Controls.Add($Cli_app_folder_lab)

$App_Description.BackColor = [System.Drawing.Color]::FromArgb(255,255,255,255)
$App_Description.DataBindings.DefaultDataSourceUpdateMode = 0
$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 16
$System_Drawing_Point.Y = 76
$App_Description.Location = $System_Drawing_Point
$App_Description.Name = "App_Description"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 20
$System_Drawing_Size.Width = 436
$App_Description.Size = $System_Drawing_Size
$App_Description.TabIndex = 1

$PublishNew.Controls.Add($App_Description)

$AppDescription_lab.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 16
$System_Drawing_Point.Y = 58
$AppDescription_lab.Location = $System_Drawing_Point
$AppDescription_lab.Name = "AppDescription"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 15
$System_Drawing_Size.Width = 128
$AppDescription_lab.Size = $System_Drawing_Size
$AppDescription_lab.TabIndex = 2
$AppDescription_lab.Text = "Application Description:"
$AppDescription_lab.add_Click($handler_label6_Click)

$PublishNew.Controls.Add($AppDescription_lab)

$Servers_pub_new_app.DataBindings.DefaultDataSourceUpdateMode = 0
$Servers_pub_new_app.FormattingEnabled = $True
$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 15
$System_Drawing_Point.Y = 263
$Servers_pub_new_app.Location = $System_Drawing_Point
$Servers_pub_new_app.Name = "Servers_pub_new_app"
$Servers_pub_new_app.ScrollAlwaysVisible = $True
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 251
$System_Drawing_Size.Width = 436
$Servers_pub_new_app.Size = $System_Drawing_Size
$Servers_pub_new_app.TabIndex = 5

$PublishNew.Controls.Add($Servers_pub_new_app)

$DisplayName_lab.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 16
$System_Drawing_Point.Y = 17
$DisplayName_lab.Location = $System_Drawing_Point
$DisplayName_lab.Name = "DisplayName_lab"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 15
$System_Drawing_Size.Width = 141
$DisplayName_lab.Size = $System_Drawing_Size
$DisplayName_lab.TabIndex = 1
$DisplayName_lab.Text = "Display name:"

$PublishNew.Controls.Add($DisplayName_lab)

$DisplayName.DataBindings.DefaultDataSourceUpdateMode = 0
$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 16
$System_Drawing_Point.Y = 35
$DisplayName.Location = $System_Drawing_Point
$DisplayName.Name = "DisplayName"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 20
$System_Drawing_Size.Width = 435
$DisplayName.Size = $System_Drawing_Size
$DisplayName.TabIndex = 0

$PublishNew.Controls.Add($DisplayName)



$label2.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 10
$System_Drawing_Point.Y = 54
$label2.Location = $System_Drawing_Point
$label2.Name = "label2"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 19
$System_Drawing_Size.Width = 160
$label2.Size = $System_Drawing_Size
$label2.TabIndex = 11
$label2.Text = "Citrix Farm Applications:"
$label2.add_Click($handler_label2_Click)

$form1.Controls.Add($label2)


$Unchech_app.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 10
$System_Drawing_Point.Y = 505
$Unchech_app.Location = $System_Drawing_Point
$Unchech_app.Name = "Unchech_app"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 23
$System_Drawing_Size.Width = 79
$Unchech_app.Size = $System_Drawing_Size
$Unchech_app.TabIndex = 2
$Unchech_app.Text = "Uncheck"
$Unchech_app.UseVisualStyleBackColor = $True
$Unchech_app.add_Click($uncheck_app_Click)

$form1.Controls.Add($Unchech_app)

$Applications.DataBindings.DefaultDataSourceUpdateMode = 0
$Applications.FormattingEnabled = $True
$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 12
$System_Drawing_Point.Y = 76
$Applications.Location = $System_Drawing_Point
$Applications.Name = "Applications"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 409
$System_Drawing_Size.Width = 300
$Applications.Size = $System_Drawing_Size
$Applications.TabIndex = 0
$Applications.add_SelectedIndexChanged($handler_checkedListBox1_SelectedIndexChanged)

    $n=0
    foreach($test in $apps)
    {
    $app=$apps[$n].ApplicationName
    [void] $Applications.Items.Add("$app")
    $n=$n+1
    }

$form1.Controls.Add($Applications)


$Check_app.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 95
$System_Drawing_Point.Y = 505
$Check_app.Location = $System_Drawing_Point
$Check_app.Name = "Check_app"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 23
$System_Drawing_Size.Width = 79
$Check_app.Size = $System_Drawing_Size
$Check_app.TabIndex = 3
$Check_app.Text = "Check"
$Check_app.UseVisualStyleBackColor = $True
$Check_app.add_Click($Check_app_OnClick)

$form1.Controls.Add($Check_app)

#endregion Generated Form Code

#Save the initial state of the form
$InitialFormWindowState = $form1.WindowState
#Init the OnLoad event to correct the initial state of the form
$form1.add_Load($OnLoadForm_StateCorrection)
#Show the Form
$form1.ShowDialog()| Out-Null

} #End Function

#Call the Function
GenerateForm
